/**
 * Solspace - Freeform
 *
 * @package		Solspace:Freeform
 * @author		Solspace DevTeam
 * @copyright	Copyright (c) 2008-2011, Solspace, Inc.
 * @link		http://solspace.com/docs/addon/c/Freeform/
 * @version		4.0.8.b1
 * @filesource	./system/expressionengine/third_party/freeform/
 *//**
 * Freeform - Composer CP JS
 *
 * @package		Solspace:Freeform
 * @author		Solspace DevTeam
 * @filesource	./themes/third_party/freeform/js/composer_cp.js
 */(function(e,t){"use strict";function ut(e,n,s){var o=12/s,u=[],a=s;while(a--)u.push("");var f=x({data:u,colspan:o.toString()});rt[n]=f;e.click(function(){var e=t(f).appendTo(i);lt(e,"row")});e.draggable({connectToSortable:"#composer_rows",forceHelperSize:!0,zIndex:1e3,helper:function(){et=!1;var e=t(this).clone().addClass("insert_element_width").height(t(this).outerHeight()).remove().appendTo(r).css("zIndex",3e3);return e}})}function at(e){e=e||!1;if(e===!1){t(".field_tag").each(function(){at(t(this))});return}e.draggable({connectToSortable:"#composer .connectedSortable",revert:!0,revertDuration:0,zIndex:1e3,helper:function(){return t(F({fieldLabel:e.text()})).remove().appendTo(r).css("zIndex",3e3).get(0)},start:function(e,t){t.helper.width(t.helper.outerWidth())}})}function ft(e,n,r){r=r||!1;var s=e.attr("data-element-id");nt[s]=U({elementId:"nonfield_"+s,element:n,requireable:t.inArray(s,ot)>-1?"yes":"no"});e.click(function(){var e=x({data:[nt[s]],colspan:"12"}),n=t(e).appendTo(i);lt(n,"row")});at(e)}function lt(e,n){i.sortable("refresh");i.find("tr:not(.no_sort) td:not(.row_control_holder)").sortable({connectWith:"#composer .connectedSortable",items:".element_wrapper",handle:".element_cover",forcePlaceholderSize:!1,stop:function(e,n){var r=t(this),i=n.item;if(n.item.is(".field_tag")){var s=n.item.attr("data-field-name");i.replaceWith(mt(s));setTimeout(function(){lt(r);ct()},0)}else if(n.item.is(".insert_element")){var o=n.item.attr("data-element-id");i.replaceWith(nt[o]);setTimeout(function(){lt(r);ct()},0)}return n},start:function(e,t){t.helper.width()>400&&t.helper.width(400);t.helper.height(t.helper.css("height","").outerHeight());return t}});ht()}function ct(){var e=r.find('.element_wrapper[data-element-id]:not([data-element-id^="nonfield"])'),n=t("#field_list .field_tag"),i={};n.removeClass("disabled");if(e.length>0){n.each(function(){var e=t(this);i[e.attr("data-field-name")]=e});e.each(function(){if(typeof i[t(this).attr("data-element-id")]=="undefined")return;i[t(this).attr("data-element-id")].addClass("disabled")})}}function ht(){t(".row_control").each(function(){var e=t(this),n=e.parent().parent(),r=n.find("td").length;r==5?e.find(".row_add_column").addClass("disabled"):e.find(".row_add_column").removeClass("disabled");r==2?e.find(".row_remove_column").addClass("disabled"):e.find(".row_remove_column").removeClass("disabled")})}function pt(e,n){var r=t("#field_edit_form"),i=r.attr("action"),s=n||!1;Freeform.initFieldEvents();Freeform.setUpChosenSelect(r);r.submit(function(e){e.preventDefault();var n=r.serializeArray();n.push({name:"include_field_data",value:"true"});n=t.param(n);t.fancybox.showActivity();t.post(i,n,function(e){t(".validation_error_holder").hide();if(!e.success){t.fancybox.hideActivity();Freeform.showValidationErrors(e.errors,r)}else s!==!1?dt(s,e,function(){t.fancybox.hideActivity();t.fancybox.close()}):vt(e,function(){t.fancybox.hideActivity();t.fancybox.close()})},"json");return!1});setTimeout(function(){t("#fancybox-wrap").stop().css({top:"50px"})},0)}function dt(e,n,r){if(n.success){var i=n.composerFieldData.fieldName,s=n.composerFieldData.fieldId;Freeform.composerFieldData[i]=n.composerFieldData;if(e!=i){t('.field_tag[data-field-name="'+e+'"]').attr("data-field-name",i);t('.element_wrapper[data-element-id="'+e+'"]').attr("data-element-id",i)}var o=t('.field_tag[data-field-name="'+i+'"]'),u=o.hasClass("disabled");o.replaceWith(q({fieldName:i,fieldLabel:n.composerFieldData.fieldLabel}));u&&t('.field_tag[data-field-name="'+i+'"]').addClass("disabled");t('.element_wrapper[data-element-id="'+i+'"]').replaceWith(mt(i));lt();at()}typeof r=="function"&&r()}function vt(e,n){if(e.success){var r=e.composerFieldData.fieldName,i=e.composerFieldData.fieldId;Freeform.composerFieldData[r]=e.composerFieldData;Freeform.composerFieldIdList[r]=i;t("#field_list").append(q({fieldName:r,fieldLabel:e.composerFieldData.fieldLabel}));at()}typeof n=="function"&&n()}function mt(e,t){return U({elementId:e,elementLabel:Freeform.composerFieldData[e].fieldLabel,element:Freeform.atob(Freeform.composerFieldData[e].fieldOutput),required:t||"no"})}function gt(e){e=e||!1;var n=t("#composer_rows tr"),r=[],i=[],s=!1,o=!1;tt=!1;n.each(function(){var e=[],n=t(this),u=n.find("td:not(.row_control_holder)");if(n.hasClass("page_break_holder")){s=!0;o||(tt=!0);r.push("page_break");o=!1;return}u.each(function(){var n=t(this),r=n.find(".element_wrapper"),s=[];r.each(function(){var e=t(this),n=e.attr("data-element-id"),r=e.attr("data-required"),u={},a="",f="";u.required=r;if(n.match(/^nonfield_/)){var l=n.replace("nonfield_","");u.type=n;if(l=="paragraph"){f=t.trim(e.find(".editable_paragraph .paragraph_content").html());f!==Freeform.composerLang.dblClickEdit?u.html=f:u.html=""}else if(l=="user_recipients"){a=t.trim(e.find(".editable_userrec .element_label:first").text().replace(/\*$/igm,""));a!==Freeform.composerLang.notfyFriends?u.html=Freeform.formPrep(a):u.html=Freeform.composerLang.notfyFriends}else if(l=="dynamic_recipients"){var c=e.find(".editable_dynrec"),h=c.find("[data-recipients]"),p=c.find(".element_label"),d="",v="",m="select",g=0;if(h.length>0){var y=h.attr("data-recipients");if(typeof y=="string"){var b;try{b=JSON.parse(t.trim(y))}catch(w){b=!1}b&&(d=b)}var E=h.attr("data-type");if(E==="select"||E==="checks")m=E;var S=parseInt(h.attr("data-notification-id"),10);isNaN(S)||(g=S)}p.length>0&&p.text()&&(v=p.text().replace(/\*$/igm,""));u.data=d;u.label=v;u.outputType=m;u.notificationId=g}else if(l=="submit"){o=!0;a=t.trim(e.find(".editable_submit button:first").text());a!==Freeform.composerLang.submit?u.html=Freeform.formPrep(a):u.html=Freeform.composerLang.submit}else if(l=="submit_previous"){a=t.trim(e.find(".editable_submit_previous button:first").text());a!==Freeform.composerLang.submit_previous?u.html=Freeform.formPrep(a):u.html=Freeform.composerLang.submit_previous}}else{u.type="field";u.fieldId=Freeform.composerFieldData[n].fieldId;i.push(u.fieldId)}s.push(u)});e.push(s)});r.push(e)});!s&&!o&&(tt=!0);var u={rows:r,fields:i};return JSON.stringify(u)}function yt(e){return t("<div>"+e+"</div>").find(":not("+Freeform.allowedHtmlTags.join(", ")+")").removeTags().end().html()}function bt(e){var n=t("#dynrec_editor"),r=t(".type_value_label_holder:first",n);n.delegate(".freeform_delete_button","click",function(){t(this).parent().remove()});Freeform.autoDupeLastInput(r,"value_label_holder_input");Freeform.setUpChosenSelect(n);n.find(".dynrec_edit.finished").click(function(r){var i=t('[name="dynrec_type"]:checked').val()=="checks"?"checks":"select",s={};n.find(".value_label_holder_input").each(function(){var e=t(this),n=t.trim(e.find('[name^="list_value_holder_input"]:first').val()),r=t.trim(e.find('[name^="list_label_holder_input"]:first').val());n!==""&&r!==""&&(s[n]=r)});var o=t.trim(n.find('[name="dynrec_output_label"]').val()),u=n.find("#dynrec_notification_id").val();e.replaceWith(N({label:Freeform.formPrep(o),data:s,jsonData:Freeform.formPrep(JSON.stringify(s)),type:i,notificationId:u}));t.fancybox.close();r.preventDefault();return!1})}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et=!1,tt=!1,nt={},rt={},it=[],st={width:"90%",overlayOpacity:"0.75",onStart:function(){t("#fancybox-content").addClass("solspace_ui_wrapper")}},ot=["dynamic_recipients","user_recipients","captcha"];t(function(){function xt(e,n){n=St===!1?!1:!0;t.fancybox.showActivity();var r=gt();if(!wt&&tt){t.fancybox.hideActivity();Freeform.jQUIDialog({immediate:!0,cancel:Freeform.composerLang.cancel,cancelClick:function(){},ok:Freeform.composerLang.continueAnyway,okClick:function(){wt=!0;t("#save_composer").submit()},message:Freeform.composerLang.missingSubmits});e.preventDefault();return!1}t("#composer_save_data").val(r);t("#composer_template_id").val(t("#composer_template_select").val());if(!n){t.post(Et.attr("action"),Et.serialize(),function(e){t.fancybox.hideActivity()});e.preventDefault();return!1}}_.templateSettings={evaluate:/<\{([\s\S]+?)\}>/g,interpolate:/<\{=([\s\S]+?)\}>/g,escape:/<\{-([\s\S]+?)\}>/g};s=t("#composer_wrapper");r=t("#composer",s);p=t("#single_row_button",s);o=t("#double_row_button",s);m=t("#triple_row_button",s);c=t("#quadruple_row_button",s);a=t("#title_button",s);l=t("#paragraph_button",s);f=t("#page_break_button",s);n=t("#captcha_button",s);u=t("#dynamic_recipients_button",s);g=t("#user_recipients_button",s);d=t("#submit_button_button",s);v=t("#submit_previous_button_button",s);i=t("#composer_rows",s);h=t("#search_clear_button",s);y=t("#composer_side_bar",s);b=t("#sticky_controls",s);E=t("#captcha_template").html();w=t("#column_template").html();T=t("#composer_row_template").html().replace("<{= columnTemplate }>",w);C=t("#dynrec_template").html();L=t("#edit_dynrec_template").html();O=t("#edit_paragraph_template").html();D=t("#edit_submit_button_template").html();H=t("#edit_submit_previous_button_template").html();j=t("#edit_userrec_template").html();I=t("#field_drag_template").html();I=t("#field_drag_template").html();R=t("#field_tag_template").html();z=t("#field_wrapper_template").html();W=t("#page_break_template").html();V=t("#paragraph_template").html();J=t("#submit_button_template").html();Q=t("#submit_previous_button_template").html();G=t("#textarea_template").html();Z=t("#userrec_template").html();S=_.template(w);x=_.template(T);N=_.template(C);k=_.template(L);A=_.template(O);M=_.template(D);P=_.template(H);B=_.template(j);F=_.template(I);q=_.template(R);U=_.template(z);X=_.template(V);$=_.template(J);K=_.template(Q);Y=_.template(Z);var e=x({data:[W],colspan:"12",notSortable:!1});ut(p,"single",1);ut(o,"double",2);ut(m,"triple",3);ut(c,"quadruple",4);f.click(function(){var n=t(e);n.addClass("page_break_holder no_sort").appendTo(i);lt(n,"row")});f.draggable({connectToSortable:"#composer_rows",forceHelperSize:!0,zIndex:1e3,helper:function(){et=!1;return t(this).clone().addClass("insert_element_width taller").css("text-align","center").height(t(this).outerHeight()).remove().appendTo(r).css({zIndex:3e3,paddingRight:0})}});ft(a,"<h2>"+Freeform.composerLang.formLabel+"</h2>");ft(n,E);ft(d,$());ft(v,K());ft(l,X());ft(u,N());ft(g,Y());r.delegate(".element_wrapper:has(.editable_paragraph)","dblclick",function(){var e=t(this),n=e.find(".editable_paragraph"),r=n.find(".paragraph_content").html(),i=Freeform.composerLang.dblClickEdit==t.trim(r)?"":t.trim(r);n.replaceWith(A({data:Freeform.formPrep(i)}));e.find(".element_cover").hide();e.find(".editor textarea").get(0).focus()});r.delegate(".element_wrapper .paragraph_edit.finished","click",function(){var e=t(this),n=e.closest(".element_wrapper"),r=n.find(".editor"),i=r.find("textarea:first"),s=t.trim(i.val()),o=Freeform.composerLang.dblClickEdit;if(s!==""&&s!==o){t.fancybox.showActivity();o=yt(Security.xssClean(s));t.fancybox.hideActivity()}r.replaceWith(X({data:o}));n.find(".element_cover").show()});r.delegate(".element_wrapper:has(.editable_submit)","dblclick",function(){var e=t(this),n=e.find(".editable_submit"),r=n.find(" button:first").text(),i=Freeform.composerLang.submit==t.trim(r)?"":t.trim(r);n.replaceWith(M({data:Freeform.formPrep(i)}));e.find(".element_cover").hide();e.find(".editor input").get(0).focus()});r.delegate(".element_wrapper:has(.editable_submit_previous)","dblclick",function(){var e=t(this),n=e.find(".editable_submit_previous"),r=n.find(" button:first").text(),i=Freeform.composerLang.submit_previous==t.trim(r)?"":t.trim(r);n.replaceWith(P({data:Freeform.formPrep(i)}));e.find(".element_cover").hide();e.find(".editor input").get(0).focus()});r.delegate(".element_wrapper .submit_edit.finished","click",function(){var e=t(this),n=e.closest(".element_wrapper"),r=n.find(".editor"),i=r.find('input[name="submit_edit"]:first'),s=t.trim(i.val()),o=Freeform.composerLang.submit;s!==""&&s!==o&&(o=Freeform.formPrep(s));r.replaceWith($({data:o}));n.find(".element_cover").show()});r.delegate(".element_wrapper .submit_previous_edit.finished","click",function(){var e=t(this),n=e.closest(".element_wrapper"),r=n.find(".editor"),i=r.find('input[name="submit_previous_edit"]:first'),s=t.trim(i.val()),o=Freeform.composerLang.submit_previous;s!==""&&s!==o&&(o=Freeform.formPrep(s));r.replaceWith(K({data:o}));n.find(".element_cover").show()});r.delegate(".element_wrapper:has(.editable_userrec)","dblclick",function(){var e=t(this),n=e.find(".editable_userrec"),r=n.find(".element_label").text().replace(/\*$/igm,""),i=Freeform.composerLang.notfyFriends==t.trim(r)?"":t.trim(r);n.replaceWith(B({data:Freeform.formPrep(i)}));e.find(".element_cover").hide();e.find(".editor input").get(0).focus()});r.delegate(".element_wrapper .userrec_edit.finished","click",function(){var e=t(this),n=e.closest(".element_wrapper"),r=n.find(".editor"),i=r.find('input[name="userrec_edit"]:first'),s=t.trim(i.val()),o=Freeform.composerLang.notfyFriends;s!==""&&s!==o&&(o=Freeform.formPrep(s));r.replaceWith(Y({data:o}));n.find(".element_cover").show()});r.delegate(".element_wrapper:has(.editable_dynrec)","dblclick",function(){var e=t(this),n=e.find(".editable_dynrec"),r=n.find("[data-recipients]"),i=n.find(".element_label"),s="",o="",u="select",a=0;if(r.length>0){var f=r.attr("data-recipients");if(typeof f=="string")try{s=JSON.parse(t.trim(f))}catch(l){s=""}var c=r.attr("data-type");if(c==="select"||c==="checks")u=c;var h=parseInt(r.attr("data-notification-id"),10);isNaN(h)||(a=h)}i.length>0&&i.text()&&(o=i.text().replace(/\*$/igm,""));t.fancybox(_.extend(st,{content:k({data:s,label:Freeform.formPrep(o),type:u,notificationId:a}),onComplete:function(){t(this).stop();t.fancybox.center();bt(n)}}))});t("#field_list").delegate(".field_tag","click",function(e){var n=t(this),r=n.attr("data-field-name");if(n.hasClass("disabled"))return!1;var s=t(x({data:[mt(r)],colspan:"12"}));s.appendTo(i);n.addClass("disabled");lt(s,"row");e.preventDefault();return!1});t.get(Freeform.url.newField,function(e){Freeform.newFieldHtml=e;t("#new_field_button").fancybox(_.extend(st,{content:Freeform.newFieldHtml,onComplete:function(){pt(this)}}))});t("#field_list").delegate(".field_tag .freeform_edit_button","click",function(e){var n=t(this),r=n.parent().attr("data-field-name"),i=Freeform.composerFieldData[r];t.fancybox.showActivity();t.post(i.fieldEditUrl,function(e){t.fancybox(_.extend(st,{content:e,onComplete:function(){pt(this,r)}}))});e.preventDefault();return!1});i.sortable({handle:".row_control .freeform_drag_button",containment:"#composer > table tbody",axis:"y",items:"tr",forceHelperSize:!0,helper:function(e,n){n.children().each(function(){var e=t(this);e.width(e.outerWidth())});return n},receive:function(n,r){var i=t(this),s,o=i.data().sortable.currentItem;et=!0;if(r.item.is('[id$="_row_button"]')){var u=r.item.attr("id").replace("_row_button","");s=t(rt[u]);o.replaceWith(s);setTimeout(function(){lt(s,"row")},0)}else if(r.item.attr("data-element-id")=="page_break"){s=t(e);s.addClass("page_break_holder no_sort");o.replaceWith(s);setTimeout(function(){lt(s,"row")},0)}return r},over:function(e,t){et=!0}});r.droppable({accept:".row_button",drop:function(e,n){n.draggable.attr("id")?t("#"+n.draggable.attr("id")).click():et?et=!1:setTimeout(function(){if(et)return;var e=/[a-z]+\_row\_button/g.exec(n.draggable.attr("class"));typeof e[0]!="undefined"&&t("#"+e[0]).click()},0)}});r.delegate(".element_control .element_require","click",function(e){var n=t(this);n.closest(".element_wrapper").attr("data-required","yes");e.preventDefault();return!1});r.delegate(".element_control .element_unrequire","click",function(e){var n=t(this);n.closest(".element_wrapper").attr("data-required","no");e.preventDefault();return!1});r.delegate(".element_control .element_delete","click",function(e){var n=t(this);n.closest(".element_wrapper").remove();ct();e.preventDefault();return!1});r.delegate(".row_control .row_delete, .page_break_holder .freeform_delete_button","click",function(e){var n=t(this);n.closest("tr").remove();ct();e.preventDefault();return!1});r.delegate(".row_control .row_add_column","click",function(e){var n=t(this),r=n.closest("tr"),i=r.find("td:not(.row_control_holder)");if(i.length<4){var s=12/(i.length+1);i.last().after(S({colspan:s}));i=r.find("td:not(.row_control_holder)");i.attr("colspan",s).css("width",Freeform.fractionToFloat(s,12,96)+"%")}ht();lt();e.preventDefault();return!1});r.delegate(".row_control .row_remove_column","click",function(e){var n=t(this),r=n.closest("tr"),i=r.find("td:not(.row_control_holder)");if(i.length>1){var s=12/(i.length-1);i.last().remove();i=r.find("td:not(.row_control_holder)");i.attr("colspan",s).css("width",Freeform.fractionToFloat(s,12,96)+"%")}ht();ct();e.preventDefault();return!1});at();var it=0,ot="",dt=function(){var e=t("#composer_template_select").val();t.fancybox(_.extend(_.clone(st),{width:"95%",height:"95%",type:"iframe",href:Freeform.url.composerPreview+"&preview_id="+it+"&template_id="+e+"&cache_bust="+(new Date).getTime(),title:Freeform.composerLang.previewTitle+": "+Freeform.composerLang.formLabel,onComplete:function(){t(this).stop();t.fancybox.center()}}))},vt=function(e){t.fancybox.showActivity();e!==ot?t.post(Freeform.url.composerSave,{preview:"y",composer_data:e,XID:EE.XID||Freeform.XID},function(t){ot=e;it=t.composerId;dt()},"json"):dt()},wt=typeof Freeform.disableMissingSubmit!="undefined"&&Freeform.disableMissingSubmit===!0;t("#preview").click(function(e){var t=gt();!wt&&tt?Freeform.jQUIDialog({immediate:!0,cancel:Freeform.composerLang.cancel,cancelClick:function(){},ok:Freeform.composerLang.continueAnyway,okClick:function(){vt(t)},message:Freeform.composerLang.missingSubmits}):vt(t);e.preventDefault();return!1}).css("cursor","pointer");var Et=t("#save_composer"),St=!0;t("#save_composer").submit(xt);t("#save_and_finish").click(function(e){St=!0}).css("cursor","pointer");t("#quicksave").click(function(e){St=!1}).css("cursor","pointer");t("#clear_all").click(function(){Freeform.jQUIDialog({immediate:!0,cancel:Freeform.composerLang.cancel,cancelClick:function(){},ok:Freeform.composerLang.ok,okClick:function(){r.find(".row_control .row_delete, .page_break_holder .freeform_delete_button").click()},message:Freeform.composerLang.clearAllWarn})});typeof Freeform.composerLayoutData.rows!="undefined"?setTimeout(function(){var e,n,r,s,o,u,a,l,c,h,p=Freeform.composerLayoutData.rows,d=1;for(e=0,n=p.length;e<n;e++){if(p[e]=="page_break"){f.click();d++;continue}a=p[e];c=[];for(r=0,s=a.length;r<s;r++){l=a[r];h="";for(o=0,u=l.length;o<u;o++)l[o].type=="nonfield_title"?h+=nt.title:l[o].type=="nonfield_paragraph"?l[o].html===""?h+=nt.paragraph:h+=U({elementId:"nonfield_paragraph",element:X({data:l[o].html})}):l[o].type=="nonfield_user_recipients"?l[o].html===""?h+=nt.paragraph:h+=U({elementId:"nonfield_user_recipients",element:Y({data:l[o].html}),requireable:"yes",reqiured:typeof l[o].required!="undefined"&&l[o].required=="yes"?"yes":"no"}):l[o].type=="nonfield_dynamic_recipients"?l[o].html===""?h+=nt.dynrec:h+=U({elementId:"nonfield_dynamic_recipients",element:N({jsonData:Freeform.formPrep(JSON.stringify(l[o].data)),data:l[o].data,label:Freeform.formPrep(l[o].label),type:l[o].outputType,notificationId:typeof l[o].notificationId!="undefined"?l[o].notificationId:0}),requireable:"yes",reqiured:typeof l[o].required!="undefined"&&l[o].required=="yes"?"yes":"no"}):l[o].type=="nonfield_captcha"?h+=nt.captcha:l[o].type=="nonfield_submit"?typeof l[o].html=="undefined"||l[o].html===""?h+=nt.submit:h+=U({elementId:"nonfield_submit",element:$({data:Freeform.formPrep(l[o].html)})}):l[o].type=="nonfield_submit_previous"?typeof l[o].html=="undefined"||l[o].html===""?h+=nt.submit_previous:h+=U({elementId:"nonfield_submit_previous",element:K({data:Freeform.formPrep(l[o].html)})}):l[o].type=="field"&&typeof l[o].fieldId!="undefined"&&typeof Freeform.composerFieldIdList[l[o].fieldId]!="undefined"&&(h+=mt(Freeform.composerFieldIdList[l[o].fieldId],typeof l[o].required!="undefined"&&l[o].required=="yes"?"yes":"no"));c.push(h)}var v=t(x({data:c,colspan:12/c.length})).appendTo(i);lt(v,"row");ct()}},0):a.click();var Tt=y.offset().top-parseFloat(y.css("margin-top").replace(/auto/,0)),Nt=y.outerHeight(),Ct=t("div.pageContents .solspace_ui_wrapper:first"),kt=Ct.offset().top-parseFloat(Ct.css("margin-top").replace(/auto/,0)),Lt;t(window).scroll(function(e){Lt=Ct.outerHeight();var n=kt+Lt,r=t(this).scrollTop();if(b.is(":checked")&&r>=Tt)if(r+Nt>n){y.removeClass("sticky");y.addClass("sticky-bottom")}else{y.removeClass("sticky-bottom");y.addClass("sticky")}else{y.removeClass("sticky-bottom");y.removeClass("sticky")}});Freeform.elementSearch("#search_fields","#field_list .field_tag",".field_label","html");h.click(function(){t("#search_fields").val("").keyup();h.hide()}).hide();var At=0;t("body").delegate("#search_fields","keyup",function(e){var n=t(this);clearTimeout(At);At=setTimeout(function(){t.trim(n.val())===""||n.attr("placeholder")&&n.val()==n.attr("placeholder")?h.hide():h.show()},100)})})})(window,jQuery);